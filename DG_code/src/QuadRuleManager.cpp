#include "QuadRuleManager.hpp"

namespace dgfem
{

const QuadRule<Eigen::Vector3d>& QuadRuleManager::getTetraRule(unsigned doe)
{
  if(doe == 0)
    return tetraRules_[0];
  if(doe > tetraRules_.size())
    return tetraRules_.back();

  return tetraRules_[doe - 1];
}

const QuadRule<Eigen::Vector2d>& QuadRuleManager::getTriaRule(unsigned doe)
{
  if(doe == 0)
    return triaRules_[0];
  if(doe > triaRules_.size())
    return triaRules_.back();

  return triaRules_[doe - 1];
}

// void QuadRuleManager::addTetraRule(const QuadRule<Eigen::Vector3d>& rule)
// {
//   tetraRules_.push_back(rule);
// }
//
// void QuadRuleManager::addTriaRule(const QuadRule<Eigen::Vector2d>& rule)
// {
//   triaRules_.push_back(rule);
// }

std::vector<QuadRule<Eigen::Vector3d>> QuadRuleManager::tetraRules_{
  // 1 point, degree of exactness = 1, [Quarteroni]
  {1,
  {{0.25, 0.25, 0.25}},
  {1./6.}},

  // 4 points, degree od exactness = 2, [Quarteroni]
  // 0.138196601125011 = (5 - sqrt(5))/20
  // 0.585410196624969 = (5 + 3*sqrt(5))/20
  {2,
  {{0.585410196624969, 0.138196601125011, 0.138196601125011},
   {0.138196601125011, 0.585410196624969, 0.138196601125011},
   {0.138196601125011, 0.138196601125011, 0.585410196624969},
   {0.138196601125011, 0.138196601125011, 0.138196601125011}},
  {1./24., 1./24., 1./24., 1./24.}},

  // 5 points, degree of exactness = 3, [Quarteroni]
  // N.B. negative weight!
  {3,
  {{0.25, 0.25, 0.25},
   {0.5,   1./6., 1./6.},
   {1./6.,  0.5,  1./6.},
   {1./6., 1./6.,  0.5},
   {1./6., 1./6., 1./6.}},
  {-4./30., 0.075, 0.075, 0.075, 0.075}},

  // 11 points, degree of freedom = 4, [Keast]
  // N.B. negative weight!
  {4,
  {{0.25, 0.25, 0.25},
   {0.0714285714285714285, 0.0714285714285714285, 0.0714285714285714285},
   {0.785714285714285714, 0.0714285714285714285, 0.0714285714285714285},
   {0.0714285714285714285, 0.785714285714285714, 0.0714285714285714285},
   {0.0714285714285714285, 0.0714285714285714285, 0.785714285714285714},
   {0.399403576166799219, 0.100596423833200785, 0.100596423833200785},
   {0.100596423833200785, 0.399403576166799219, 0.100596423833200785},
   {0.100596423833200785, 0.100596423833200785, 0.399403576166799219},
   {0.100596423833200785, 0.399403576166799219, 0.399403576166799219},
   {0.399403576166799219, 0.100596423833200785, 0.399403576166799219},
   {0.399403576166799219, 0.399403576166799219, 0.100596423833200785}},
  {-0.0131555555555555550, 0.00762222222222222222, 0.00762222222222222222,
   0.00762222222222222222, 0.00762222222222222222, 0.0248888888888888880,
    0.0248888888888888880, 0.0248888888888888880,  0.0248888888888888880,
    0.0248888888888888880, 0.0248888888888888880}},

  // 15 points, degree of freedom = 5, [Keast]
  {5,
  {{0.25, 0.25, 0.25},
   {1./3., 1./3., 1./3.},
   {0.0, 1./3., 1./3.},
   {1./3., 0.0, 1./3.},
   {1./3., 1./3., 0.0},
   {1./11., 1./11., 1./11.},
   {8./11., 1./11., 1./11.},
   {1./11., 8./11., 1./11.},
   {1./11., 1./11., 8./11.},
   {0.4334498464263357, 0.0665501535736643, 0.0665501535736643},
   {0.0665501535736643, 0.4334498464263357, 0.0665501535736643},
   {0.0665501535736643, 0.0665501535736643, 0.4334498464263357},
   {0.0665501535736643, 0.4334498464263357, 0.4334498464263357},
   {0.4334498464263357, 0.0665501535736643, 0.4334498464263357},
   {0.4334498464263357, 0.4334498464263357, 0.0665501535736643}},
  {0.0302836780970891856,  0.00602678571428571597, 0.00602678571428571597,
   0.00602678571428571597, 0.00602678571428571597, 0.0116452490860289742,
   0.0116452490860289742,  0.0116452490860289742,  0.0116452490860289742,
   0.0109491415613864534,  0.0109491415613864534,  0.0109491415613864534,
   0.0109491415613864534,  0.0109491415613864534,  0.0109491415613864534}},

  // 24 points, degree of freedom = 6, [Keast]
  {6,
  {{0.00665379170969464506, 0.00665379170969464506, 0.00665379170969464506},
   {0.356191386222544953, 0.00665379170969464506, 0.00665379170969464506},
   {0.00665379170969464506, 0.356191386222544953, 0.00665379170969464506},
   {0.00665379170969464506, 0.00665379170969464506, 0.356191386222544953},
   {0.0406739585346113397, 0.0406739585346113397, 0.0406739585346113397},
   {0.877978124396165982, 0.0406739585346113397, 0.0406739585346113397},
   {0.0406739585346113397, 0.877978124396165982, 0.0406739585346113397},
   {0.0406739585346113397, 0.0406739585346113397, 0.877978124396165982},
   {0.322337890142275646, 0.322337890142275646, 0.322337890142275646},
   {0.0329863295731730594, 0.322337890142275646, 0.322337890142275646},
   {0.322337890142275646, 0.0329863295731730594, 0.322337890142275646},
   {0.322337890142275646, 0.322337890142275646, 0.0329863295731730594},
   {0.0636610018750175299, 0.0636610018750175299, 0.269672331458315867},
   {0.0636610018750175299, 0.0636610018750175299, 0.603005664791649076},
   {0.0636610018750175299, 0.269672331458315867, 0.0636610018750175299},
   {0.0636610018750175299, 0.269672331458315867, 0.603005664791649076},
   {0.0636610018750175299, 0.603005664791649076, 0.0636610018750175299},
   {0.0636610018750175299, 0.603005664791649076, 0.269672331458315867},
   {0.269672331458315867, 0.0636610018750175299, 0.0636610018750175299},
   {0.269672331458315867, 0.0636610018750175299, 0.603005664791649076},
   {0.269672331458315867, 0.603005664791649076, 0.0636610018750175299},
   {0.603005664791649076, 0.0636610018750175299, 0.0636610018750175299},
   {0.603005664791649076, 0.0636610018750175299, 0.269672331458315867},
   {0.603005664791649076, 0.269672331458315867, 0.0636610018750175299}},
  {0.00665379170969464506, 0.00665379170969464506, 0.00665379170969464506,
    0.00665379170969464506, 0.00167953517588677620, 0.00167953517588677620,
    0.00167953517588677620, 0.00167953517588677620, 0.00922619692394239843,
    0.00922619692394239843, 0.00922619692394239843, 0.00922619692394239843,
    0.00803571428571428248, 0.00803571428571428248, 0.00803571428571428248,
    0.00803571428571428248, 0.00803571428571428248, 0.00803571428571428248,
    0.00803571428571428248, 0.00803571428571428248, 0.00803571428571428248,
    0.00803571428571428248, 0.00803571428571428248, 0.00803571428571428248}},

  // 31 points, degree od exactness = 7, [Keast]
  // N.B. negative weight!
  {7,
  {{0.5, 0.0, 0.0},
   {0.0, 0.5, 0.0},
   {0.0, 0.0, 0.5},
   {0.5, 0.5, 0.0},
   {0.5, 0.0, 0.5},
   {0.0, 0.5, 0.5},
   {0.25, 0.25, 0.25},
   {0.0782131923303186549, 0.0782131923303186549, 0.0782131923303186549},
   {0.765360423009044044, 0.0782131923303186549, 0.0782131923303186549},
   {0.0782131923303186549, 0.765360423009044044, 0.0782131923303186549},
   {0.0782131923303186549, 0.0782131923303186549, 0.765360423009044044},
   {0.121843216663904411, 0.121843216663904411, 0.121843216663904411},
   {0.634470350008286765, 0.121843216663904411, 0.121843216663904411},
   {0.121843216663904411, 0.634470350008286765, 0.121843216663904411},
   {0.121843216663904411, 0.121843216663904411, 0.634470350008286765},
   {0.332539164446420554, 0.332539164446420554, 0.332539164446420554},
   {0.00238250666073834549, 0.332539164446420554, 0.332539164446420554},
   {0.332539164446420554, 0.00238250666073834549, 0.332539164446420554},
   {0.332539164446420554, 0.332539164446420554, 0.00238250666073834549},
   {0.1, 0.1, 0.2},
   {0.1, 0.1, 0.6},
   {0.1, 0.2, 0.1},
   {0.1, 0.2, 0.6},
   {0.1, 0.6, 0.1},
   {0.1, 0.6, 0.2},
   {0.2, 0.1, 0.1},
   {0.2, 0.1, 0.6},
   {0.2, 0.6, 0.1},
   {0.6, 0.1, 0.1},
   {0.6, 0.1, 0.2},
   {0.6, 0.2, 0.1}},
  {0.000970017636684296702, 0.000970017636684296702, 0.000970017636684296702,
   0.000970017636684296702, 0.000970017636684296702, 0.000970017636684296702,
   0.0182642234661087939, 0.0105999415244141609, 0.0105999415244141609,
   0.0105999415244141609, 0.0105999415244141609, -0.0625177401143299494,
  -0.0625177401143299494, -0.0625177401143299494, -0.0625177401143299494,
   0.00489142526307353653, 0.00489142526307353653, 0.00489142526307353653,
   0.00489142526307353653, 0.0275573192239850917, 0.0275573192239850917,
   0.0275573192239850917, 0.0275573192239850917, 0.0275573192239850917,
   0.0275573192239850917, 0.0275573192239850917, 0.0275573192239850917,
   0.0275573192239850917, 0.0275573192239850917, 0.0275573192239850917,
   0.0275573192239850917}},

   // 45 points, degree of exactness = 8, [Keast]
   {8,
   {{0.25, 0.25, 0.25},
    {0.127470936566639015, 0.127470936566639015, 0.127470936566639015},
    {0.617587190300082967, 0.127470936566639015, 0.127470936566639015},
    {0.127470936566639015, 0.617587190300082967, 0.127470936566639015},
    {0.127470936566639015, 0.127470936566639015, 0.617587190300082967},
    {0.0320788303926322960, 0.0320788303926322960, 0.0320788303926322960},
    {0.903763508822103123, 0.0320788303926322960, 0.0320788303926322960},
    {0.0320788303926322960, 0.903763508822103123, 0.0320788303926322960},
    {0.0320788303926322960, 0.0320788303926322960, 0.903763508822103123},
    {0.450222904356718978, 0.0497770956432810185, 0.0497770956432810185},
    {0.0497770956432810185, 0.450222904356718978, 0.0497770956432810185},
    {0.0497770956432810185, 0.0497770956432810185, 0.450222904356718978},
    {0.0497770956432810185, 0.450222904356718978, 0.450222904356718978},
    {0.450222904356718978, 0.0497770956432810185, 0.450222904356718978},
    {0.450222904356718978, 0.450222904356718978, 0.0497770956432810185},
    {0.316269552601450060, 0.183730447398549945, 0.183730447398549945},
    {0.183730447398549945, 0.316269552601450060, 0.183730447398549945},
    {0.183730447398549945, 0.183730447398549945, 0.316269552601450060},
    {0.183730447398549945, 0.316269552601450060, 0.316269552601450060},
    {0.316269552601450060, 0.183730447398549945, 0.316269552601450060},
    {0.316269552601450060, 0.316269552601450060, 0.183730447398549945},
    {0.0229177878448171174, 0.231901089397150906, 0.231901089397150906},
    {0.231901089397150906, 0.0229177878448171174, 0.231901089397150906},
    {0.231901089397150906, 0.231901089397150906, 0.0229177878448171174},
    {0.513280033360881072, 0.231901089397150906, 0.231901089397150906},
    {0.231901089397150906, 0.513280033360881072, 0.231901089397150906},
    {0.231901089397150906, 0.231901089397150906, 0.513280033360881072},
    {0.0229177878448171174, 0.513280033360881072, 0.231901089397150906},
    {0.0229177878448171174, 0.231901089397150906, 0.513280033360881072},
    {0.513280033360881072, 0.0229177878448171174, 0.231901089397150906},
    {0.513280033360881072, 0.231901089397150906, 0.0229177878448171174},
    {0.231901089397150906, 0.0229177878448171174, 0.513280033360881072},
    {0.231901089397150906, 0.513280033360881072, 0.0229177878448171174},
    {0.730313427807538396, 0.0379700484718286102, 0.0379700484718286102},
    {0.0379700484718286102, 0.730313427807538396, 0.0379700484718286102},
    {0.0379700484718286102, 0.0379700484718286102, 0.730313427807538396},
    {0.193746475248804382, 0.0379700484718286102, 0.0379700484718286102},
    {0.0379700484718286102, 0.193746475248804382, 0.0379700484718286102},
    {0.0379700484718286102, 0.0379700484718286102, 0.193746475248804382},
    {0.0379700484718286102, 0.730313427807538396, 0.193746475248804382},
    {0.0379700484718286102, 0.193746475248804382, 0.730313427807538396},
    {0.730313427807538396, 0.193746475248804382, 0.0379700484718286102},
    {0.730313427807538396, 0.0379700484718286102, 0.193746475248804382},
    {0.193746475248804382, 0.730313427807538396, 0.0379700484718286102},
    {0.193746475248804382, 0.0379700484718286102, 0.730313427807538396}},
   {0.0393270066412926145, 0.00408131605934270525, 0.00408131605934270525,
    0.00408131605934270525, 0.00408131605934270525, 0.000658086773304341943,
    0.000658086773304341943, 0.000658086773304341943, 0.000658086773304341943,
    0.00438425882512284693, 0.00438425882512284693, 0.00438425882512284693,
    0.00438425882512284693, 0.00438425882512284693, 0.00438425882512284693,
    0.0138300638425098166, 0.0138300638425098166, 0.0138300638425098166,
    0.0138300638425098166, 0.0138300638425098166, 0.0138300638425098166,
    0.00424043742468372453, 0.00424043742468372453, 0.00424043742468372453,
    0.00424043742468372453, 0.00424043742468372453, 0.00424043742468372453,
    0.00424043742468372453, 0.00424043742468372453, 0.00424043742468372453,
    0.00424043742468372453, 0.00424043742468372453, 0.00424043742468372453,
    0.00223873973961420164, 0.00223873973961420164, 0.00223873973961420164,
    0.00223873973961420164, 0.00223873973961420164, 0.00223873973961420164,
    0.00223873973961420164, 0.00223873973961420164, 0.00223873973961420164,
    0.00223873973961420164, 0.00223873973961420164, 0.00223873973961420164,
    0.00223873973961420164, 0.00223873973961420164, 0.00223873973961420164,
    0.00223873973961420164, 0.00223873973961420164, 0.00223873973961420164}}};



std::vector<QuadRule<Eigen::Vector2d>> QuadRuleManager::triaRules_;



}
